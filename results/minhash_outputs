Successfully loaded from Parquet file.
=== Full Dataset Diagnostics ===
Number of users (full): 330975
Unique MinHash signatures (full): 320667
+--------------------+-----+
|    minhashSignature|count|
+--------------------+-----+
|[572512732, 44155...|  837|
|[111889932, 34569...|  230|
|[963252350, 41695...|  213|
|[1407454, 1198678...|  186|
|[373197739, 24672...|  158|
|[665871411, 42576...|  146|
|[668828486, 86442...|  124|
|[173701643, 61577...|  124|
|[75816800, 187802...|  117|
|[994105325, 58983...|  110|
+--------------------+-----+
only showing top 10 rows

+-------+------------------+
|summary|         numMovies|
+-------+------------------+
|  count|            330975|
|   mean|102.21969030893572|
| stddev|232.15453015036755|
|    min|                 1|
|    25%|                15|
|    50%|                31|
|    75%|                98|
|    max|             33332|
+-------+------------------+

Number of users after filtering (movieSet size ≥ 3): 316754
Unique MinHash signatures (filtered): 314129
+--------------------+-----+
|    minhashSignature|count|
+--------------------+-----+
|[111889932, 34569...|  230|
|[1407454, 1198678...|  186|
|[75816800, 187802...|  117|
|[1407454, 1198678...|   58|
|[24007855, 345695...|   45|
|[111889932, 34569...|   43|
|[24007855, 345695...|   29|
|[1407454, 4169588...|   27|
|[202653742, 32012...|   27|
|[1407454, 1198678...|   22|
+--------------------+-----+
only showing top 10 rows

+-------+------------------+
|summary|         numMovies|
+-------+------------------+
|  count|            316754|
|   mean|106.74623840582913|
| stddev| 236.3018337050854|
|    min|                 3|
|    25%|                15|
|    50%|                34|
|    75%|               103|
|    max|             33332|
+-------+------------------+

Number of users after filtering (movieSet size ≥ 3): 316754
Unique MinHash signatures (filtered): 314129
+--------------------+-----+
|    minhashSignature|count|
+--------------------+-----+
|[111889932, 34569...|  230|
|[1407454, 1198678...|  186|
|[75816800, 187802...|  117|
|[1407454, 1198678...|   58|
|[24007855, 345695...|   45|
|[111889932, 34569...|   43|
|[24007855, 345695...|   29|
|[1407454, 4169588...|   27|
|[202653742, 32012...|   27|
|[1407454, 1198678...|   22|
+--------------------+-----+
only showing top 10 rows

+-------+------------------+
|summary|         numMovies|
+-------+------------------+  
|  count|            316754   |
|   mean|106.74623840582913|
| stddev| 236.3018337050854|
|    min|                 3|
|    25%|                15|
|    50%|                34|
|    75%|               103|
|    max|             33332|
+-------+------------------+

Sample Output:
|userId|movieSet                                                                                                                                                                                                                                                                                                                                                                           |minhashSignature                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
+------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|1     |[356, 4995, 1293, 4699, 1214, 2028, 381, 7706, 1066, 1210, 4993, 1291, 4306, 596, 53996, 3363, 8533, 2116, 1537, 40629, 1196, 4246, 3578, 1960, 49647, 8981, 2085, 1, 1200, 1396, 7153, 52458, 33794, 4896, 54259, 2762, 8969, 1036, 8644, 6539, 5952, 7122, 4886, 7064, 8132, 2804, 7139, 8961, 2908, 1049, 7162, 1376, 7366, 158, 260, 33166, 1959, 2336, 2671, 1909, 2571, 110] |[13929747, 25401685, 11572021, 19565320, 3850016, 3836155, 1835525, 6390012, 14436153, 7963940, 846208, 38887442, 29311098, 3798722, 4743735, 15775408, 27599801, 18754204, 13310084, 22483647, 18565, 6899558, 47137463, 16107093, 17702533, 2269931, 12118568, 24156180, 18719688, 13833446, 5184897, 10376660, 29165109, 12111826, 8549274, 15263107, 6463429, 41595152, 1954341, 28774725, 18576312, 8041204, 41286535, 525869, 14782447, 1420858, 7588851, 16194654, 19333093, 2149954, 12971936, 2326303, 853763, 3707201, 16965520, 3216859, 15595249, 3152152, 4121594, 2345560, 8639183, 48549273, 304073, 2069298, 30768208, 5252053, 2870470, 13413543, 10566063, 11193562, 71078306, 39848528, 4208172, 41353285, 1317651, 3319429, 16589266, 17460929, 169040, 5650415, 10542052, 47114579, 17632890, 14215432, 75922662, 6525558, 55188185, 25440492, 9588288, 6882885, 3237551, 13378184, 533227, 9609673, 12380746, 2560491, 55297392, 6520357, 502369259, 20768999, 1618182, 22596737, 2816388, 80264318, 8094423, 25530950, 12038403, 42771540, 8453229, 9369953, 5096644, 5276333, 31005139, 3563270, 1909916, 5607855, 8286096, 9946739, 3395800, 12611549, 1455552, 3781946, 38140027, 4683927, 6547102, 23949919, 35611075, 34937090]                       |
|3     |[76093, 115713, 69844, 116797, 185029, 134853, 88125, 3751, 2959, 176101, 68954, 296, 3114, 74458, 81834, 152081, 4886, 858, 177765, 112556, 109487, 6377, 8961, 99114, 318, 119145, 60069, 115617, 79132, 187593]                                                                                                                                                                 |[104197993, 4789125, 19966075, 24244224, 38344091, 24638526, 35201057, 96604242, 2774668, 75858460, 600511, 6894742, 45916239, 3798722, 6838459, 22700893, 26548498, 18754204, 19713734, 288413, 29165705, 13696875, 64516950, 36087045, 9188242, 51498847, 63549303, 2464828, 40022964, 23690488, 28446698, 43227513, 9427857, 11934543, 28257470, 80542215, 51740744, 4714510, 72584903, 9428787, 67104331, 14127211, 8598847, 55398990, 20523614, 16576250, 5326138, 33598884, 5805034, 27883066, 24866814, 35863, 1894409, 56420972, 151770, 10864192, 30835429, 12394819, 11931839, 35531084, 7424722, 41803071, 31139681, 89902755, 17043132, 50829883, 24247245, 52247716, 26830562, 11193562, 20841489, 3704061, 20699309, 54888568, 36289537, 32842968, 1692796, 20329469, 18022757, 26329066, 13342393, 8072497, 16185242, 5313908, 61329475, 76491052, 46106857, 78840160, 4715602, 736473, 29155323, 61317115, 30041185, 6290875, 6519794, 62707565, 11224565, 25018600, 4073711, 1778216, 53942006, 6588883, 140665212, 2225832, 46032909, 43936554, 4035585, 90042, 55614250, 5314942, 49421661, 6107350, 14181581, 3563270, 47931373, 11262932, 12401810, 4845977, 11389071, 24845595, 36197362, 13200411, 100341, 40041746, 1589711, 42620735, 31912631, 14607411]|
|6     |[3753, 356, 60, 1801, 2746, 4995, 1476, 1222, 7153, 24, 2028, 3147, 44191, 47, 1136, 2428, 1726, 2959, 1036, 1210, 2858, 4993, 2329, 296, 2431, 58559, 5952, 1213, 1590, 1591, 4226, 1918, 5418, 170, 1994, 135, 593, 318, 4571, 50872, 1704, 1196, 260, 2539, 3578, 1270, 2571, 110]                                                                                              |[129632382, 12788210, 1375861, 8820980, 23904251, 21633928, 1835525, 2662248, 12513398, 51444142, 846208, 38887442, 8222460, 9238759, 42870786, 675304, 7451853, 43970481, 13310084, 18878807, 22909146, 28740767, 27875314, 31858017, 15008407, 43163284, 42238563, 14648647, 40022964, 13833446, 5184897, 8700854, 14364471, 868393, 5378397, 14406904, 6365312, 41595152, 56302496, 39669540, 19496264, 14127211, 12449453, 7806100, 4544818, 7065453, 291072, 91889017, 770343, 8782217, 10610741, 15997283, 1894409, 10079491, 5247979, 7152522, 33353857, 3152152, 2727425, 10455991, 8639183, 3166159, 304073, 40667750, 64565972, 31278916, 2870470, 16388998, 21748216, 49278949, 5835851, 12954060, 17725793, 15457617, 20242138, 3319429, 6674554, 22187430, 169040, 36048614, 26257706, 24308513, 18760366, 14215432, 14185767, 67986140, 113132710, 15702721, 14593807, 7644891, 21877365, 31417246, 24793204, 9824697, 7802809, 14174252, 24415094, 6520357, 404234659, 13059277, 1618182, 11651847, 3299627, 5547071, 2360687, 25530950, 12038403, 90042, 11729246, 5492994, 5096644, 18375583, 14181581, 16669919, 1909916, 13673022, 18286467, 21578647, 7580071, 28929952, 23425185, 49787854, 43962472, 38929655, 300398, 3857805, 4334806, 3177246]           |
|12    |[9, 996, 1, 743, 1120, 104, 786, 1498, 990, 736, 1367, 25, 788, 839, 628, 1391, 832, 761, 1210, 1363, 1393, 1059, 733, 784, 653, 704, 886, 95, 1438, 879, 858, 1459, 494, 647, 626, 880, 1431, 648, 780, 141, 802, 112, 62, 1456, 12, 63, 673, 64, 818, 1356, 1429, 260, 6, 798, 849]                                                                                              |[5752515, 6166791, 21458921, 54636714, 567844, 5975496, 6024741, 22233009, 4329565, 3295482, 9814343, 6894742, 50234084, 465387, 32679441, 4621097, 2056585, 42496778, 26554751, 19521861, 11686510, 24519673, 43854370, 10223471, 9697901, 2269931, 13663229, 781851, 27403110, 11260613, 4223968, 16745445, 6683605, 942779, 10793296, 12846816, 21237345, 13074752, 20910602, 2984525, 7213081, 23237663, 8645983, 7800483, 24127643, 6189472, 52462851, 35898097, 1925386, 3491716, 2938583, 22504626, 101033101, 9042397, 2052286, 15868901, 8504341, 1787386, 16088890, 492950, 18254664, 20641361, 2664049, 33809171, 33414731, 3095392, 31737501, 9890183, 13986023, 584753, 2579596, 10171031, 18339228, 868903, 33231498, 2664956, 1692796, 32676864, 169040, 5100076, 56691194, 59851748, 41344611, 29293198, 10884187, 2344877, 4033677, 17652184, 11929844, 7136887, 7847564, 24597912, 16856579, 56968229, 24317294, 28757497, 2616920, 11255823, 706480794, 10951004, 37990010, 52607213, 5567275, 29164562, 18822214, 25530950, 8576978, 17332232, 6533774, 20125340, 5402877, 11128029, 9111402, 6915746, 15849595, 2842644, 7177926, 20880068, 13992372, 17508989, 22453142, 14181509, 29782584, 32961334, 32264586, 22826038, 7529691, 2481949]                |
|76    |[589, 4262, 4995, 95207, 168250, 1214, 1193, 48780, 2959, 228099, 296, 5618, 1997, 158783, 1206, 8641, 1258, 750, 48516, 115569, 111, 55820, 6016, 1704, 106920, 5989, 3020, 270698, 115713, 54286, 32, 3147, 81591, 2762, 55908, 47, 2712, 2329, 8950, 58559, 130636, 74458, 1213, 4226, 953, 274053, 71535, 293, 1201, 98607, 593, 1203, 318, 1682, 8528, 217465, 3535, 364, 110]|[43394736, 12788210, 11572021, 189687, 23904251, 14260342, 1835525, 10677721, 33674665, 17137239, 21926594, 1700027, 8553764, 9238759, 93056789, 9069129, 26920751, 5280348, 12026747, 7692878, 28407801, 6510605, 37012812, 6178497, 5860738, 17215997, 64144697, 51178960, 12275326, 10550204, 10974369, 10124928, 14645018, 12111826, 12744184, 3520998, 6365312, 1826890, 23836166, 58177696, 10521224, 6994880, 644157, 23662017, 16912918, 15862352, 16222915, 14247760, 5129459, 18571911, 23763231, 7730268, 1894409, 27720437, 7056708, 107016, 26675327, 3152152, 13569605, 1211567, 17982453, 25966720, 10578934, 4191623, 7354191, 12178448, 8931613, 1083408, 12860874, 35980362, 5835851, 62230787, 19170459, 43657320, 22997558, 3319429, 43956399, 1142453, 9073201, 28987484, 1609960, 3871286, 16505414, 3685869, 9722455, 6525558, 3671061, 124912, 5393258, 18365521, 9631001, 9000941, 5901322, 9824697, 21182233, 21769148, 5656178, 2283217, 41387681, 691987, 25227615, 11651847, 2481696, 2691883, 1208616, 58736222, 24001566, 90042, 11901911, 1265839, 6558725, 14153432, 5538686, 17556662, 1909916, 4439192, 46854755, 4845977, 1455279, 21811176, 8784448, 31939755, 32697377, 23741414, 13382336, 3946045, 4334806, 14607411]                     |
+------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
only showing top 5 rows


Number of band buckets: 7269356
+-------+------------------+
|summary|        group_size|
+-------+------------------+
|  count|           7269356|
|   mean|1.3943639574124584|
| stddev| 6.793761586884374|
|    min|                 1|
|    25%|                 1|
|    50%|                 1|
|    75%|                 1|
|    max|              4502|
+-------+------------------+

Number of buckets with >1 user: 668688
+---------------+
|max(group_size)|
+---------------+
|           4502|
+---------------+

saving to parquet
